# WindowsFinder
**WindowFinder:** 旨在帮助 快速发现Windows机器上面的系列信息

## TODO LIST⏱️
 - [x] 列出Windows服务器上面所有系统用户
 - [ ] 列出Windows服务器上面的计划任务
 - [x] 分析RDP日志 获取一些重要的信息
 - [ ] 启动项信息获取
 - [x] 进程信息获取
 - [ ] 网络信息获取
 - [ ] 加一个简易的图形化页面(预计要等到很久以后了)
## 优化日志
**2025年7月16日**  
对基础信息收集模块进行了优化修改, 由原本的  
输出`用户名、用户全名、权限级别、主目录、登录服务器、注释、账户状态、登录次数、错误密码次数、上次登录时间、账户过期时间`等信息改为了只输出`用户名信息`  
独立出一个系统用户信息收集模块 用户课根据自己的需要设置level值不同的level值收集不同程序的信息
level值是设置参考微软给出的[信息级别设置](https://learn.microsoft.com/zh-cn/windows/win32/api/lmaccess/nf-lmaccess-netuserenum)  
下面为简要的不同level值返回的信息表格  
目前level值级别值 仅支持设置为`0,1,2,3`

| 值   | 结构体名     | 包含信息概要                                                 |
| ---- | ------------ | ------------------------------------------------------------ |
| 0    | USER_INFO_0  | 用户名（usri0_name）                                         |
| 1    | USER_INFO_1  | 用户名、密码、权限等级、账号状态（启用/禁用）、注释、主目录、脚本路径 |
| 2    | USER_INFO_2  | Level 1 + 登录限制、错误密码次数、登录次数、上次登录时间、账户过期时间、认证标志等 |
| 3    | USER_INFO_3  | Level 2 + 用户 RID、主组 RID、配置文件路径、登录缓存等（多用于域用户/AD） |
| 10   | USER_INFO_10 | 用户名、全名、注释、用户备注                                 |
| 11   | USER_INFO_11 | Level 10 + 权限、标志位、脚本路径、登录限制、登录次数、主目录、上次登录等 |
| 20   | USER_INFO_20 | 用户 RID、组 RID、标志、登录缓存、密码过期时间、账号过期时间等（更偏向内部标识符） |
| 23   | USER_INFO_23 | 建议使用的新结构，类似于 Level 3，适用于 Windows XP 及之后，安全性更强，支持 SID 等 |



**2025年7月24日**
修复了原来 `事件21、25、1149`相关日志无法完整搜集出的bug
由于`事件21、25、1149`相关日志输出信息可能会比较多，故将其从原本的`基础信息收集`模块中移出  
单独成立一个新的模块 收集RDP相关的信息 目前只收集 `事件21、 事件25 事件1149`的相关信息后续可能会计划加入更多的信息收集  
**2025年9月2日**
添加了收集系统进程的功能。  
此外， 决定日后放弃cli形式, 改用GUI图形化方式或者Web图形化方式

**免责声明：此工具仅限于安全研究，用户承担因使用此工具而导致的所有法律和相关责任！作者不承担任何法律责任**